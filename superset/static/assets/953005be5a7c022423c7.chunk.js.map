{"version":3,"file":"953005be5a7c022423c7.chunk.js","mappings":"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","sources":["webpack://superset/./packages/superset-ui-core/src/time-comparison/customTimeRangeDecode.ts","webpack://superset/./packages/superset-ui-core/src/time-comparison/fetchTimeRange.ts","webpack://superset/./src/components/DatePicker/index.tsx","webpack://superset/./src/components/Popover/Popover.tsx","webpack://superset/./src/explore/components/controls/ControlPopover/ControlPopover.tsx","webpack://superset/./src/explore/components/controls/DateFilterControl/components/CommonFrame.tsx","webpack://superset/./src/explore/components/controls/DateFilterControl/components/CalendarFrame.tsx","webpack://superset/./src/explore/components/controls/DateFilterControl/components/CurrentCalendarFrame.tsx","webpack://superset/./src/explore/components/controls/DateFilterControl/components/CustomFrame.tsx","webpack://superset/./src/explore/components/controls/DateFilterControl/components/DateFunctionTooltip.tsx","webpack://superset/./src/explore/components/controls/DateFilterControl/components/AdvancedFrame.tsx","webpack://superset/./src/explore/components/controls/DateFilterControl/components/DateLabel.tsx","webpack://superset/./src/explore/components/controls/DateFilterControl/DateFilterLabel.tsx","webpack://superset/./src/explore/components/controls/DateFilterControl/types.ts","webpack://superset/./src/explore/components/controls/DateFilterControl/utils/constants.ts","webpack://superset/./src/explore/components/controls/DateFilterControl/utils/dateParser.ts","webpack://superset/./src/explore/components/controls/DateFilterControl/utils/dateFilterUtils.ts"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { SEPARATOR } from './fetchTimeRange';\nimport {\n  CustomRangeDecodeType,\n  CustomRangeType,\n  DateTimeGrainType,\n  DateTimeModeType,\n} from './types';\n\nconst iso8601 = String.raw`\\d{4}-\\d\\d-\\d\\dT\\d\\d:\\d\\d:\\d\\d(?:\\.\\d+)?(?:(?:[+-]\\d\\d:\\d\\d)|Z)?`;\nconst datetimeConstant = String.raw`(?:TODAY|NOW)`;\nconst grainValue = String.raw`[+-]?[1-9][0-9]*`;\nconst grain = String.raw`YEAR|QUARTER|MONTH|WEEK|DAY|HOUR|MINUTE|SECOND`;\nconst CUSTOM_RANGE_EXPRESSION = RegExp(\n  String.raw`^DATEADD\\(DATETIME\\(\"(${iso8601}|${datetimeConstant})\"\\),\\s(${grainValue}),\\s(${grain})\\)$`,\n  'i',\n);\nexport const ISO8601_AND_CONSTANT = RegExp(\n  String.raw`^${iso8601}$|^${datetimeConstant}$`,\n  'i',\n);\nconst DATETIME_CONSTANT = ['now', 'today'];\nconst SEVEN_DAYS_AGO = new Date();\nSEVEN_DAYS_AGO.setHours(0, 0, 0, 0);\n\nconst MIDNIGHT = new Date();\nMIDNIGHT.setHours(0, 0, 0, 0);\n\nconst defaultCustomRange: CustomRangeType = {\n  sinceDatetime: SEVEN_DAYS_AGO.setDate(\n    SEVEN_DAYS_AGO.getDate() - 7,\n  ).toString(),\n  sinceMode: 'relative',\n  sinceGrain: 'day',\n  sinceGrainValue: -7,\n  untilDatetime: MIDNIGHT.toString(),\n  untilMode: 'specific',\n  untilGrain: 'day',\n  untilGrainValue: 7,\n  anchorMode: 'now',\n  anchorValue: 'now',\n};\n\nexport const customTimeRangeDecode = (\n  timeRange: string,\n): CustomRangeDecodeType => {\n  const splitDateRange = timeRange.split(SEPARATOR);\n\n  if (splitDateRange.length === 2) {\n    const [since, until] = splitDateRange;\n\n    // specific : specific\n    if (ISO8601_AND_CONSTANT.test(since) && ISO8601_AND_CONSTANT.test(until)) {\n      const sinceMode = (\n        DATETIME_CONSTANT.includes(since) ? since : 'specific'\n      ) as DateTimeModeType;\n      const untilMode = (\n        DATETIME_CONSTANT.includes(until) ? until : 'specific'\n      ) as DateTimeModeType;\n      return {\n        customRange: {\n          ...defaultCustomRange,\n          sinceDatetime: since,\n          untilDatetime: until,\n          sinceMode,\n          untilMode,\n        },\n        matchedFlag: true,\n      };\n    }\n\n    // relative : specific\n    const sinceCapturedGroup = since.match(CUSTOM_RANGE_EXPRESSION);\n    if (\n      sinceCapturedGroup &&\n      ISO8601_AND_CONSTANT.test(until) &&\n      since.includes(until)\n    ) {\n      const [dttm, grainValue, grain] = sinceCapturedGroup.slice(1);\n      const untilMode = (\n        DATETIME_CONSTANT.includes(until) ? until : 'specific'\n      ) as DateTimeModeType;\n      return {\n        customRange: {\n          ...defaultCustomRange,\n          sinceGrain: grain as DateTimeGrainType,\n          sinceGrainValue: parseInt(grainValue, 10),\n          sinceDatetime: dttm,\n          untilDatetime: dttm,\n          sinceMode: 'relative',\n          untilMode,\n        },\n        matchedFlag: true,\n      };\n    }\n\n    // specific : relative\n    const untilCapturedGroup = until.match(CUSTOM_RANGE_EXPRESSION);\n    if (\n      ISO8601_AND_CONSTANT.test(since) &&\n      untilCapturedGroup &&\n      until.includes(since)\n    ) {\n      const [dttm, grainValue, grain] = [...untilCapturedGroup.slice(1)];\n      const sinceMode = (\n        DATETIME_CONSTANT.includes(since) ? since : 'specific'\n      ) as DateTimeModeType;\n      return {\n        customRange: {\n          ...defaultCustomRange,\n          untilGrain: grain as DateTimeGrainType,\n          untilGrainValue: parseInt(grainValue, 10),\n          sinceDatetime: dttm,\n          untilDatetime: dttm,\n          untilMode: 'relative',\n          sinceMode,\n        },\n        matchedFlag: true,\n      };\n    }\n\n    // relative : relative\n    if (sinceCapturedGroup && untilCapturedGroup) {\n      const [sinceDttm, sinceGrainValue, sinceGrain] = [\n        ...sinceCapturedGroup.slice(1),\n      ];\n      const [untilDttm, untilGrainValue, untilGrain] = [\n        ...untilCapturedGroup.slice(1),\n      ];\n      if (sinceDttm === untilDttm) {\n        return {\n          customRange: {\n            ...defaultCustomRange,\n            sinceGrain: sinceGrain as DateTimeGrainType,\n            sinceGrainValue: parseInt(sinceGrainValue, 10),\n            sinceDatetime: sinceDttm,\n            untilGrain: untilGrain as DateTimeGrainType,\n            untilGrainValue: parseInt(untilGrainValue, 10),\n            untilDatetime: untilDttm,\n            anchorValue: sinceDttm,\n            sinceMode: 'relative',\n            untilMode: 'relative',\n            anchorMode: sinceDttm === 'now' ? 'now' : 'specific',\n          },\n          matchedFlag: true,\n        };\n      }\n    }\n  }\n\n  return {\n    customRange: defaultCustomRange,\n    matchedFlag: false,\n  };\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport rison from 'rison';\nimport { isEmpty } from 'lodash';\nimport {\n  SupersetClient,\n  getClientErrorObject,\n  ensureIsArray,\n} from '@superset-ui/core';\n\nexport const SEPARATOR = ' : ';\n\nexport const buildTimeRangeString = (since: string, until: string): string =>\n  `${since}${SEPARATOR}${until}`;\n\nconst formatDateEndpoint = (dttm: string, isStart?: boolean): string =>\n  dttm.replace('T00:00:00', '') || (isStart ? '-∞' : '∞');\n\nexport const formatTimeRange = (\n  timeRange: string,\n  columnPlaceholder = 'col',\n) => {\n  const splitDateRange = timeRange.split(SEPARATOR);\n  if (splitDateRange.length === 1) return timeRange;\n  return `${formatDateEndpoint(\n    splitDateRange[0],\n    true,\n  )} ≤ ${columnPlaceholder} < ${formatDateEndpoint(splitDateRange[1])}`;\n};\n\nexport const formatTimeRangeComparison = (\n  initialTimeRange: string,\n  shiftedTimeRange: string,\n  columnPlaceholder = 'col',\n) => {\n  const splitInitialDateRange = initialTimeRange.split(SEPARATOR);\n  const splitShiftedDateRange = shiftedTimeRange.split(SEPARATOR);\n  return `${columnPlaceholder}: ${formatDateEndpoint(\n    splitInitialDateRange[0],\n    true,\n  )} to ${formatDateEndpoint(splitInitialDateRange[1])} vs\n  ${formatDateEndpoint(splitShiftedDateRange[0], true)} to ${formatDateEndpoint(\n    splitShiftedDateRange[1],\n  )}`;\n};\n\nexport const fetchTimeRange = async (\n  timeRange: string,\n  columnPlaceholder = 'col',\n  shifts?: string[],\n) => {\n  let query;\n  let endpoint;\n  if (!isEmpty(shifts)) {\n    const timeRanges = ensureIsArray(shifts).map(shift => ({\n      timeRange,\n      shift,\n    }));\n    query = rison.encode_uri([{ timeRange }, ...timeRanges]);\n    endpoint = `/api/v1/time_range/?q=${query}`;\n  } else {\n    query = rison.encode_uri(timeRange);\n    endpoint = `/api/v1/time_range/?q=${query}`;\n  }\n  try {\n    const response = await SupersetClient.get({ endpoint });\n    if (isEmpty(shifts)) {\n      const timeRangeString = buildTimeRangeString(\n        response?.json?.result[0]?.since || '',\n        response?.json?.result[0]?.until || '',\n      );\n      return {\n        value: formatTimeRange(timeRangeString, columnPlaceholder),\n      };\n    }\n    const timeRanges = response?.json?.result.map((result: any) =>\n      buildTimeRangeString(result.since, result.until),\n    );\n    return {\n      value: timeRanges\n        .slice(1)\n        .map((timeRange: string) =>\n          formatTimeRangeComparison(\n            timeRanges[0],\n            timeRange,\n            columnPlaceholder,\n          ),\n        ),\n    };\n  } catch (response) {\n    const clientError = await getClientErrorObject(response);\n    return {\n      error: clientError.message || clientError.error || response.statusText,\n    };\n  }\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { DatePicker as AntdDatePicker } from 'antd';\nimport { styled } from '@superset-ui/core';\n\nconst AntdRangePicker = AntdDatePicker.RangePicker;\n\nexport const RangePicker = styled(AntdRangePicker)`\n  border-radius: ${({ theme }) => theme.gridUnit}px;\n`;\n\nexport const DatePicker = AntdDatePicker;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { Popover as AntdPopover } from 'antd';\nimport type { PopoverProps as AntdPopoverProps } from 'antd/lib/popover';\n\nexport interface PopoverProps extends AntdPopoverProps {\n  forceRender?: boolean;\n}\n\nexport const Popover = (props: PopoverProps) => <AntdPopover {...props} />;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n// eslint-disable-next-line no-restricted-syntax -- whole React import is required for `ControlPopover.test.tsx` Jest test passing.\nimport React, { FC, useCallback, useRef, useEffect, useState } from 'react';\n\nimport Popover, {\n  PopoverProps as BasePopoverProps,\n  TooltipPlacement,\n} from 'src/components/Popover';\n\nconst sectionContainerId = 'controlSections';\nexport const getSectionContainerElement = () =>\n  document.getElementById(sectionContainerId)?.lastElementChild as HTMLElement;\n\nconst getElementYVisibilityRatioOnContainer = (node: HTMLElement) => {\n  const containerHeight = window?.innerHeight;\n  const nodePositionInViewport = node?.getBoundingClientRect()?.top;\n  if (!containerHeight || !nodePositionInViewport) {\n    return 0;\n  }\n\n  return nodePositionInViewport / containerHeight;\n};\n\nexport type PopoverProps = BasePopoverProps & {\n  getVisibilityRatio?: typeof getElementYVisibilityRatioOnContainer;\n};\n\nconst ControlPopover: FC<PopoverProps> = ({\n  getPopupContainer,\n  getVisibilityRatio = getElementYVisibilityRatioOnContainer,\n  visible: visibleProp,\n  destroyTooltipOnHide = false,\n  ...props\n}) => {\n  const triggerElementRef = useRef<HTMLElement>();\n\n  const [visible, setVisible] = useState(\n    visibleProp === undefined ? props.defaultVisible : visibleProp,\n  );\n  const [placement, setPlacement] = React.useState<TooltipPlacement>('right');\n\n  const calculatePlacement = useCallback(() => {\n    const visibilityRatio = getVisibilityRatio(triggerElementRef.current!);\n    if (visibilityRatio < 0.35 && placement !== 'rightTop') {\n      setPlacement('rightTop');\n    } else if (visibilityRatio > 0.65 && placement !== 'rightBottom') {\n      setPlacement('rightBottom');\n    } else {\n      setPlacement('right');\n    }\n  }, [getVisibilityRatio]);\n\n  const changeContainerScrollStatus = useCallback(\n    visible => {\n      const element = getSectionContainerElement();\n      if (element) {\n        element.style.setProperty(\n          'overflow-y',\n          visible ? 'hidden' : 'auto',\n          'important',\n        );\n      }\n    },\n    [calculatePlacement],\n  );\n\n  const handleGetPopupContainer = useCallback(\n    (triggerNode: HTMLElement) => {\n      triggerElementRef.current = triggerNode;\n\n      return getPopupContainer?.(triggerNode) || document.body;\n    },\n    [calculatePlacement, getPopupContainer],\n  );\n\n  const handleOnVisibleChange = useCallback(\n    (visible: boolean | undefined) => {\n      if (visible === undefined) {\n        changeContainerScrollStatus(visible);\n      }\n\n      setVisible(!!visible);\n      props.onVisibleChange?.(!!visible);\n    },\n    [props, changeContainerScrollStatus],\n  );\n\n  const handleDocumentKeyDownListener = useCallback(\n    (event: KeyboardEvent) => {\n      if (event.key === 'Escape') {\n        setVisible(false);\n        props.onVisibleChange?.(false);\n      }\n    },\n    [props],\n  );\n\n  useEffect(() => {\n    if (visibleProp !== undefined) {\n      setVisible(!!visibleProp);\n    }\n  }, [visibleProp]);\n\n  useEffect(() => {\n    if (visible !== undefined) {\n      changeContainerScrollStatus(visible);\n    }\n  }, [visible, changeContainerScrollStatus]);\n\n  useEffect(() => {\n    if (visible) {\n      document.addEventListener('keydown', handleDocumentKeyDownListener);\n    }\n\n    return () => {\n      document.removeEventListener('keydown', handleDocumentKeyDownListener);\n    };\n  }, [handleDocumentKeyDownListener, visible]);\n\n  useEffect(() => {\n    if (visible) {\n      calculatePlacement();\n    }\n  }, [visible, calculatePlacement]);\n\n  return (\n    <Popover\n      {...props}\n      visible={visible}\n      arrowPointAtCenter\n      placement={placement}\n      onVisibleChange={handleOnVisibleChange}\n      getPopupContainer={handleGetPopupContainer}\n      destroyTooltipOnHide={destroyTooltipOnHide}\n    />\n  );\n};\n\nexport default ControlPopover;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { t } from '@superset-ui/core';\nimport { Radio } from 'src/components/Radio';\nimport {\n  COMMON_RANGE_OPTIONS,\n  COMMON_RANGE_SET,\n  DateFilterTestKey,\n} from 'src/explore/components/controls/DateFilterControl/utils';\nimport {\n  CommonRangeType,\n  FrameComponentProps,\n} from 'src/explore/components/controls/DateFilterControl/types';\n\nexport function CommonFrame(props: FrameComponentProps) {\n  let commonRange = 'Last week';\n  if (COMMON_RANGE_SET.has(props.value as CommonRangeType)) {\n    commonRange = props.value;\n  } else {\n    props.onChange(commonRange);\n  }\n\n  return (\n    <>\n      <div className=\"section-title\" data-test={DateFilterTestKey.CommonFrame}>\n        {t('Configure Time Range: Last...')}\n      </div>\n      <Radio.Group\n        value={commonRange}\n        onChange={(e: any) => props.onChange(e.target.value)}\n      >\n        {COMMON_RANGE_OPTIONS.map(({ value, label }) => (\n          <Radio key={value} value={value} className=\"vertical-radio\">\n            {label}\n          </Radio>\n        ))}\n      </Radio.Group>\n    </>\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useEffect } from 'react';\nimport { t } from '@superset-ui/core';\nimport { Radio } from 'src/components/Radio';\nimport {\n  CALENDAR_RANGE_OPTIONS,\n  CALENDAR_RANGE_SET,\n} from 'src/explore/components/controls/DateFilterControl/utils';\nimport {\n  CalendarRangeType,\n  PreviousCalendarWeek,\n  FrameComponentProps,\n} from '../types';\n\nexport function CalendarFrame({ onChange, value }: FrameComponentProps) {\n  useEffect(() => {\n    if (!CALENDAR_RANGE_SET.has(value as CalendarRangeType)) {\n      onChange(PreviousCalendarWeek);\n    }\n  }, [onChange, value]);\n\n  if (!CALENDAR_RANGE_SET.has(value as CalendarRangeType)) {\n    return null;\n  }\n\n  return (\n    <>\n      <div className=\"section-title\">\n        {t('Configure Time Range: Previous...')}\n      </div>\n      <Radio.Group\n        value={value}\n        onChange={(e: any) => onChange(e.target.value)}\n      >\n        {CALENDAR_RANGE_OPTIONS.map(({ value, label }) => (\n          <Radio key={value} value={value} className=\"vertical-radio\">\n            {label}\n          </Radio>\n        ))}\n      </Radio.Group>\n    </>\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useEffect } from 'react';\nimport { t } from '@superset-ui/core';\nimport { Radio } from 'src/components/Radio';\nimport {\n  CURRENT_RANGE_OPTIONS,\n  CURRENT_CALENDAR_RANGE_SET,\n} from 'src/explore/components/controls/DateFilterControl/utils';\nimport { CurrentRangeType, CurrentWeek, FrameComponentProps } from '../types';\n\nexport function CurrentCalendarFrame({ onChange, value }: FrameComponentProps) {\n  useEffect(() => {\n    if (!CURRENT_CALENDAR_RANGE_SET.has(value as CurrentRangeType)) {\n      onChange(CurrentWeek);\n    }\n  }, [value]);\n\n  if (!CURRENT_CALENDAR_RANGE_SET.has(value as CurrentRangeType)) {\n    return null;\n  }\n\n  return (\n    <>\n      <div className=\"section-title\">\n        {t('Configure Time Range: Current...')}\n      </div>\n      <Radio.Group\n        value={value}\n        onChange={(e: any) => {\n          let newValue = e.target.value;\n          // Sanitization: Trim whitespace\n          newValue = newValue.trim();\n          // Validation: Check if the value is non-empty\n          if (newValue === '') {\n            return;\n          }\n          onChange(newValue);\n        }}\n      >\n        {CURRENT_RANGE_OPTIONS.map(({ value, label }) => (\n          <Radio key={value} value={value} className=\"vertical-radio\">\n            {label}\n          </Radio>\n        ))}\n      </Radio.Group>\n    </>\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useEffect, useState } from 'react';\nimport { useSelector } from 'react-redux';\nimport type { PickerLocale } from 'antd/lib/date-picker/generatePicker';\nimport { Moment } from 'moment';\nimport { isInteger } from 'lodash';\nimport { t, customTimeRangeDecode } from '@superset-ui/core';\nimport { InfoTooltipWithTrigger } from '@superset-ui/chart-controls';\nimport { Col, Row } from 'src/components';\nimport { InputNumber } from 'src/components/Input';\nimport { DatePicker } from 'src/components/DatePicker';\nimport { Radio } from 'src/components/Radio';\nimport Select from 'src/components/Select/Select';\nimport {\n  SINCE_GRAIN_OPTIONS,\n  SINCE_MODE_OPTIONS,\n  UNTIL_GRAIN_OPTIONS,\n  UNTIL_MODE_OPTIONS,\n  MOMENT_FORMAT,\n  MIDNIGHT,\n  customTimeRangeEncode,\n  dttmToMoment,\n  LOCALE_MAPPING,\n} from 'src/explore/components/controls/DateFilterControl/utils';\nimport {\n  CustomRangeKey,\n  FrameComponentProps,\n} from 'src/explore/components/controls/DateFilterControl/types';\nimport { ExplorePageState } from 'src/explore/types';\nimport Loading from 'src/components/Loading';\n\nexport function CustomFrame(props: FrameComponentProps) {\n  const { customRange, matchedFlag } = customTimeRangeDecode(props.value);\n  const [datePickerLocale, setDatePickerLocale] = useState<\n    PickerLocale | undefined | null\n  >(null);\n  if (!matchedFlag) {\n    props.onChange(customTimeRangeEncode(customRange));\n  }\n  const {\n    sinceDatetime,\n    sinceMode,\n    sinceGrain,\n    sinceGrainValue,\n    untilDatetime,\n    untilMode,\n    untilGrain,\n    untilGrainValue,\n    anchorValue,\n    anchorMode,\n  } = { ...customRange };\n\n  function onChange(control: CustomRangeKey, value: string) {\n    props.onChange(\n      customTimeRangeEncode({\n        ...customRange,\n        [control]: value,\n      }),\n    );\n  }\n\n  function onGrainValue(\n    control: 'sinceGrainValue' | 'untilGrainValue',\n    value: string | number,\n  ) {\n    // only positive values in grainValue controls\n    if (isInteger(value) && value > 0) {\n      props.onChange(\n        customTimeRangeEncode({\n          ...customRange,\n          [control]: value,\n        }),\n      );\n    }\n  }\n\n  function onAnchorMode(option: any) {\n    const radioValue = option.target.value;\n    if (radioValue === 'now') {\n      props.onChange(\n        customTimeRangeEncode({\n          ...customRange,\n          anchorValue: 'now',\n          anchorMode: radioValue,\n        }),\n      );\n    } else {\n      props.onChange(\n        customTimeRangeEncode({\n          ...customRange,\n          anchorValue: MIDNIGHT,\n          anchorMode: radioValue,\n        }),\n      );\n    }\n  }\n\n  // check if there is a locale defined for explore\n  const localFromFlaskBabel = useSelector(\n    (state: ExplorePageState) => state?.common?.locale,\n  );\n\n  // An undefined datePickerLocale is acceptable if no match is found in the LOCALE_MAPPING[localFromFlaskBabel] lookup\n  // and will fall back to antd's default locale when the antd DataPicker's prop locale === undefined\n  // This also protects us from the case where state is populated with a locale that antd locales does not recognize\n  useEffect(() => {\n    if (datePickerLocale === null) {\n      if (localFromFlaskBabel && LOCALE_MAPPING[localFromFlaskBabel]) {\n        LOCALE_MAPPING[localFromFlaskBabel]()\n          .then((locale: { default: PickerLocale }) =>\n            setDatePickerLocale(locale.default),\n          )\n          .catch(() => setDatePickerLocale(undefined));\n      } else {\n        setDatePickerLocale(undefined);\n      }\n    }\n  }, [datePickerLocale, localFromFlaskBabel]);\n\n  if (datePickerLocale === null) {\n    return <Loading position=\"inline-centered\" />;\n  }\n\n  return (\n    <div data-test=\"custom-frame\">\n      <div className=\"section-title\">{t('Configure custom time range')}</div>\n      <Row gutter={24}>\n        <Col span={12}>\n          <div className=\"control-label\">\n            {t('START (INCLUSIVE)')}{' '}\n            <InfoTooltipWithTrigger\n              tooltip={t('Start date included in time range')}\n              placement=\"right\"\n            />\n          </div>\n          <Select\n            ariaLabel={t('START (INCLUSIVE)')}\n            options={SINCE_MODE_OPTIONS}\n            value={sinceMode}\n            onChange={(value: string) => onChange('sinceMode', value)}\n          />\n          {sinceMode === 'specific' && (\n            <Row>\n              <DatePicker\n                showTime\n                defaultValue={dttmToMoment(sinceDatetime)}\n                onChange={(datetime: Moment) =>\n                  onChange('sinceDatetime', datetime.format(MOMENT_FORMAT))\n                }\n                allowClear={false}\n                locale={datePickerLocale}\n              />\n            </Row>\n          )}\n          {sinceMode === 'relative' && (\n            <Row gutter={8}>\n              <Col span={11}>\n                {/* Make sure sinceGrainValue looks like a positive integer */}\n                <InputNumber\n                  placeholder={t('Relative quantity')}\n                  value={Math.abs(sinceGrainValue)}\n                  min={1}\n                  defaultValue={1}\n                  onChange={value =>\n                    onGrainValue('sinceGrainValue', value || 1)\n                  }\n                  onStep={value => onGrainValue('sinceGrainValue', value || 1)}\n                />\n              </Col>\n              <Col span={13}>\n                <Select\n                  ariaLabel={t('Relative period')}\n                  options={SINCE_GRAIN_OPTIONS}\n                  value={sinceGrain}\n                  onChange={(value: string) => onChange('sinceGrain', value)}\n                />\n              </Col>\n            </Row>\n          )}\n        </Col>\n        <Col span={12}>\n          <div className=\"control-label\">\n            {t('END (EXCLUSIVE)')}{' '}\n            <InfoTooltipWithTrigger\n              tooltip={t('End date excluded from time range')}\n              placement=\"right\"\n            />\n          </div>\n          <Select\n            ariaLabel={t('END (EXCLUSIVE)')}\n            options={UNTIL_MODE_OPTIONS}\n            value={untilMode}\n            onChange={(value: string) => onChange('untilMode', value)}\n          />\n          {untilMode === 'specific' && (\n            <Row>\n              <DatePicker\n                showTime\n                defaultValue={dttmToMoment(untilDatetime)}\n                onChange={(datetime: Moment) =>\n                  onChange('untilDatetime', datetime.format(MOMENT_FORMAT))\n                }\n                allowClear={false}\n                locale={datePickerLocale}\n              />\n            </Row>\n          )}\n          {untilMode === 'relative' && (\n            <Row gutter={8}>\n              <Col span={11}>\n                <InputNumber\n                  placeholder={t('Relative quantity')}\n                  value={untilGrainValue}\n                  min={1}\n                  defaultValue={1}\n                  onChange={value =>\n                    onGrainValue('untilGrainValue', value || 1)\n                  }\n                  onStep={value => onGrainValue('untilGrainValue', value || 1)}\n                />\n              </Col>\n              <Col span={13}>\n                <Select\n                  ariaLabel={t('Relative period')}\n                  options={UNTIL_GRAIN_OPTIONS}\n                  value={untilGrain}\n                  onChange={(value: string) => onChange('untilGrain', value)}\n                />\n              </Col>\n            </Row>\n          )}\n        </Col>\n      </Row>\n      {sinceMode === 'relative' && untilMode === 'relative' && (\n        <div className=\"control-anchor-to\">\n          <div className=\"control-label\">{t('Anchor to')}</div>\n          <Row align=\"middle\">\n            <Col>\n              <Radio.Group\n                onChange={onAnchorMode}\n                defaultValue=\"now\"\n                value={anchorMode}\n              >\n                <Radio key=\"now\" value=\"now\">\n                  {t('NOW')}\n                </Radio>\n                <Radio key=\"specific\" value=\"specific\">\n                  {t('Date/Time')}\n                </Radio>\n              </Radio.Group>\n            </Col>\n            {anchorMode !== 'now' && (\n              <Col>\n                <DatePicker\n                  showTime\n                  defaultValue={dttmToMoment(anchorValue)}\n                  onChange={(datetime: Moment) =>\n                    onChange('anchorValue', datetime.format(MOMENT_FORMAT))\n                  }\n                  allowClear={false}\n                  className=\"control-anchor-to-datetime\"\n                  locale={datePickerLocale}\n                />\n              </Col>\n            )}\n          </Row>\n        </div>\n      )}\n    </div>\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useTheme, t } from '@superset-ui/core';\n\nimport { Tooltip } from 'src/components/Tooltip';\nimport { ClassNames } from '@emotion/react';\n\nconst TIME_PICKER_HELPER = (\n  <>\n    <div>\n      <h3>DATETIME</h3>\n      <p>{t('Return to specific datetime.')}</p>\n      <h4>{t('Syntax')}</h4>\n      <pre>\n        <code>datetime([string])</code>\n      </pre>\n      <h4>{t('Example')}</h4>\n      <pre>\n        <code>{`datetime(\"2020-03-01 12:00:00\")\ndatetime(\"now\")\ndatetime(\"last year\")`}</code>\n      </pre>\n    </div>\n    <div>\n      <h3>DATEADD</h3>\n      <p>{t('Moves the given set of dates by a specified interval.')}</p>\n      <h4>{t('Syntax')}</h4>\n      <pre>\n        <code>{`dateadd([datetime], [integer], [dateunit])\ndateunit = (year | quarter | month | week | day | hour | minute | second)`}</code>\n      </pre>\n      <h4>{t('Example')}</h4>\n      <pre>\n        <code>{`dateadd(datetime(\"today\"), -13, day)\ndateadd(datetime(\"2020-03-01\"), 2, day)`}</code>\n      </pre>\n    </div>\n    <div>\n      <h3>DATETRUNC</h3>\n      <p>\n        {t(\n          'Truncates the specified date to the accuracy specified by the date unit.',\n        )}\n      </p>\n      <h4>{t('Syntax')}</h4>\n      <pre>\n        <code>{`datetrunc([datetime], [dateunit])\ndateunit = (year | quarter | month | week)`}</code>\n      </pre>\n      <h4>{t('Example')}</h4>\n      <pre>\n        <code>{`datetrunc(datetime(\"2020-03-01\"), week)\ndatetrunc(datetime(\"2020-03-01\"), month)`}</code>\n      </pre>\n    </div>\n    <div>\n      <h3>LASTDAY</h3>\n      <p>{t('Get the last date by the date unit.')}</p>\n      <h4>{t('Syntax')}</h4>\n      <pre>\n        <code>{`lastday([datetime], [dateunit])\ndateunit = (year | month | week)`}</code>\n      </pre>\n      <h4>{t('Example')}</h4>\n      <pre>\n        <code>lastday(datetime(\"today\"), month)</code>\n      </pre>\n    </div>\n    <div>\n      <h3>HOLIDAY</h3>\n      <p>{t('Get the specify date for the holiday')}</p>\n      <h4>{t('Syntax')}</h4>\n      <pre>\n        <code>{`holiday([string])\nholiday([holiday string], [datetime])\nholiday([holiday string], [datetime], [country name])`}</code>\n      </pre>\n      <h4>{t('Example')}</h4>\n      <pre>\n        <code>{`holiday(\"new year\")\nholiday(\"christmas\", datetime(\"2019\"))\nholiday(\"christmas\", dateadd(datetime(\"2019\"), 1, year))\nholiday(\"christmas\", datetime(\"2 years ago\"))\nholiday(\"Easter Monday\", datetime(\"2019\"), \"UK\")`}</code>\n      </pre>\n    </div>\n  </>\n);\n\nconst StyledTooltip = (props: any) => {\n  const theme = useTheme();\n  return (\n    <ClassNames>\n      {({ css }) => (\n        <Tooltip\n          overlayClassName={css`\n            .ant-tooltip-content {\n              min-width: ${theme.gridUnit * 125}px;\n              max-height: 410px;\n              overflow-y: scroll;\n\n              .ant-tooltip-inner {\n                max-width: ${theme.gridUnit * 125}px;\n                h3 {\n                  font-size: ${theme.typography.sizes.m}px;\n                  font-weight: ${theme.typography.weights.bold};\n                }\n                h4 {\n                  font-size: ${theme.typography.sizes.m}px;\n                  font-weight: ${theme.typography.weights.bold};\n                }\n                pre {\n                  border: none;\n                  text-align: left;\n                  word-break: break-word;\n                  font-size: ${theme.typography.sizes.s}px;\n                }\n              }\n            }\n          `}\n          {...props}\n        />\n      )}\n    </ClassNames>\n  );\n};\n\nexport default function DateFunctionTooltip(props: any) {\n  return <StyledTooltip title={TIME_PICKER_HELPER} {...props} />;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { SEPARATOR, t } from '@superset-ui/core';\nimport { Input } from 'src/components/Input';\nimport { InfoTooltipWithTrigger } from '@superset-ui/chart-controls';\nimport { FrameComponentProps } from 'src/explore/components/controls/DateFilterControl/types';\nimport DateFunctionTooltip from './DateFunctionTooltip';\n\nfunction getAdvancedRange(value: string): string {\n  if (value.includes(SEPARATOR)) {\n    return value;\n  }\n  if (value.startsWith('Last')) {\n    return [value, ''].join(SEPARATOR);\n  }\n  if (value.startsWith('Next')) {\n    return ['', value].join(SEPARATOR);\n  }\n  return SEPARATOR;\n}\n\nexport function AdvancedFrame(props: FrameComponentProps) {\n  const advancedRange = getAdvancedRange(props.value || '');\n  const [since, until] = advancedRange.split(SEPARATOR);\n  if (advancedRange !== props.value) {\n    props.onChange(getAdvancedRange(props.value || ''));\n  }\n\n  function onChange(control: 'since' | 'until', value: string) {\n    if (control === 'since') {\n      props.onChange(`${value}${SEPARATOR}${until}`);\n    } else {\n      props.onChange(`${since}${SEPARATOR}${value}`);\n    }\n  }\n\n  return (\n    <>\n      <div className=\"section-title\">\n        {t('Configure Advanced Time Range ')}\n        <DateFunctionTooltip placement=\"rightBottom\">\n          <i className=\"fa fa-info-circle text-muted\" />\n        </DateFunctionTooltip>\n      </div>\n      <div className=\"control-label\">\n        {t('START (INCLUSIVE)')}{' '}\n        <InfoTooltipWithTrigger\n          tooltip={t('Start date included in time range')}\n          placement=\"right\"\n        />\n      </div>\n      <Input\n        key=\"since\"\n        value={since}\n        onChange={e => onChange('since', e.target.value)}\n      />\n      <div className=\"control-label\">\n        {t('END (EXCLUSIVE)')}{' '}\n        <InfoTooltipWithTrigger\n          tooltip={t('End date excluded from time range')}\n          placement=\"right\"\n        />\n      </div>\n      <Input\n        key=\"until\"\n        value={until}\n        onChange={e => onChange('until', e.target.value)}\n      />\n    </>\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { forwardRef, MouseEvent, ReactNode, RefObject } from 'react';\n\nimport { css, styled, useTheme, t } from '@superset-ui/core';\nimport Icons from 'src/components/Icons';\n\nexport type DateLabelProps = {\n  label: ReactNode;\n  isActive?: boolean;\n  isPlaceholder?: boolean;\n  onClick?: (event: MouseEvent) => void;\n};\n\n// This is the color that antd components (such as Select or Input) use on hover\n// TODO: use theme.colors.primary.base here and in antd components\nconst ACTIVE_BORDER_COLOR = '#45BED6';\n\nconst LabelContainer = styled.div<{\n  isActive?: boolean;\n  isPlaceholder?: boolean;\n}>`\n  ${({ theme, isActive, isPlaceholder }) => css`\n    width: 100%;\n    height: ${theme.gridUnit * 8}px;\n\n    display: flex;\n    align-items: center;\n    flex-wrap: nowrap;\n\n    padding: 0 ${theme.gridUnit * 3}px;\n\n    background-color: ${theme.colors.grayscale.light5};\n\n    border: 1px solid\n      ${isActive ? ACTIVE_BORDER_COLOR : theme.colors.grayscale.light2};\n    border-radius: ${theme.borderRadius}px;\n\n    cursor: pointer;\n\n    transition: border-color 0.3s cubic-bezier(0.65, 0.05, 0.36, 1);\n    :hover,\n    :focus {\n      border-color: ${ACTIVE_BORDER_COLOR};\n    }\n\n    .date-label-content {\n      color: ${isPlaceholder\n        ? theme.colors.grayscale.light1\n        : theme.colors.grayscale.dark1};\n      overflow: hidden;\n      text-overflow: ellipsis;\n      min-width: 0;\n      flex-shrink: 1;\n      white-space: nowrap;\n    }\n\n    span[role='img'] {\n      margin-left: auto;\n      padding-left: ${theme.gridUnit}px;\n\n      & > span[role='img'] {\n        line-height: 0;\n      }\n    }\n  `}\n`;\n\nexport const DateLabel = forwardRef(\n  (props: DateLabelProps, ref: RefObject<HTMLSpanElement>) => {\n    const theme = useTheme();\n    return (\n      <LabelContainer {...props} tabIndex={0}>\n        <span className=\"date-label-content\" ref={ref}>\n          {typeof props.label === 'string' ? t(props.label) : props.label}\n        </span>\n        <Icons.CalendarOutlined\n          iconSize=\"s\"\n          iconColor={theme.colors.grayscale.base}\n        />\n      </LabelContainer>\n    );\n  },\n);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { ReactNode, useState, useEffect, useMemo } from 'react';\nimport {\n  css,\n  styled,\n  t,\n  useTheme,\n  NO_TIME_RANGE,\n  SupersetTheme,\n  useCSSTextTruncation,\n  fetchTimeRange,\n} from '@superset-ui/core';\nimport Button from 'src/components/Button';\nimport ControlHeader from 'src/explore/components/ControlHeader';\nimport Modal from 'src/components/Modal';\nimport { Divider } from 'src/components';\nimport Icons from 'src/components/Icons';\nimport Select from 'src/components/Select/Select';\nimport { Tooltip } from 'src/components/Tooltip';\nimport { useDebouncedEffect } from 'src/explore/exploreUtils';\nimport { SLOW_DEBOUNCE } from 'src/constants';\nimport { noOp } from 'src/utils/common';\nimport ControlPopover from '../ControlPopover/ControlPopover';\n\nimport { DateFilterControlProps, FrameType } from './types';\nimport {\n  DateFilterTestKey,\n  FRAME_OPTIONS,\n  guessFrame,\n  useDefaultTimeFilter,\n} from './utils';\nimport {\n  CommonFrame,\n  CalendarFrame,\n  CustomFrame,\n  AdvancedFrame,\n  DateLabel,\n} from './components';\nimport { CurrentCalendarFrame } from './components/CurrentCalendarFrame';\n\nconst StyledRangeType = styled(Select)`\n  width: 272px;\n`;\n\nconst ContentStyleWrapper = styled.div`\n  ${({ theme }) => css`\n    .ant-row {\n      margin-top: 8px;\n    }\n\n    .ant-input-number {\n      width: 100%;\n    }\n\n    .ant-picker {\n      padding: 4px 17px 4px;\n      border-radius: 4px;\n      width: 100%;\n    }\n\n    .ant-divider-horizontal {\n      margin: 16px 0;\n    }\n\n    .control-label {\n      font-size: 11px;\n      font-weight: ${theme.typography.weights.medium};\n      color: ${theme.colors.grayscale.light2};\n      line-height: 16px;\n      margin: 8px 0;\n    }\n\n    .vertical-radio {\n      display: block;\n      height: 40px;\n      line-height: 40px;\n    }\n\n    .section-title {\n      font-style: normal;\n      font-weight: ${theme.typography.weights.bold};\n      font-size: 15px;\n      line-height: 24px;\n      margin-bottom: 8px;\n    }\n\n    .control-anchor-to {\n      margin-top: 16px;\n    }\n\n    .control-anchor-to-datetime {\n      width: 217px;\n    }\n\n    .footer {\n      text-align: right;\n    }\n  `}\n`;\n\nconst IconWrapper = styled.span`\n  span {\n    margin-right: ${({ theme }) => 2 * theme.gridUnit}px;\n    vertical-align: middle;\n  }\n  .text {\n    vertical-align: middle;\n  }\n  .error {\n    color: ${({ theme }) => theme.colors.error.base};\n  }\n`;\n\nconst getTooltipTitle = (\n  isLabelTruncated: boolean,\n  label: string | undefined,\n  range: string | undefined,\n) =>\n  isLabelTruncated ? (\n    <div>\n      {label && <strong>{label}</strong>}\n      {range && (\n        <div\n          css={(theme: SupersetTheme) => css`\n            margin-top: ${theme.gridUnit}px;\n          `}\n        >\n          {range}\n        </div>\n      )}\n    </div>\n  ) : (\n    range || null\n  );\n\nexport default function DateFilterLabel(props: DateFilterControlProps) {\n  const {\n    onChange,\n    onOpenPopover = noOp,\n    onClosePopover = noOp,\n    overlayStyle = 'Popover',\n    isOverflowingFilterBar = false,\n  } = props;\n  const defaultTimeFilter = useDefaultTimeFilter();\n\n  const value = props.value ?? defaultTimeFilter;\n  const [actualTimeRange, setActualTimeRange] = useState<string>(value);\n\n  const [show, setShow] = useState<boolean>(false);\n  const guessedFrame = useMemo(() => guessFrame(value), [value]);\n  const [frame, setFrame] = useState<FrameType>(guessedFrame);\n  const [lastFetchedTimeRange, setLastFetchedTimeRange] = useState(value);\n  const [timeRangeValue, setTimeRangeValue] = useState(value);\n  const [validTimeRange, setValidTimeRange] = useState<boolean>(false);\n  const [evalResponse, setEvalResponse] = useState<string>(value);\n  const [tooltipTitle, setTooltipTitle] = useState<ReactNode | null>(value);\n  const theme = useTheme();\n  const [labelRef, labelIsTruncated] = useCSSTextTruncation<HTMLSpanElement>();\n\n  useEffect(() => {\n    if (value === NO_TIME_RANGE) {\n      setActualTimeRange(NO_TIME_RANGE);\n      setTooltipTitle(null);\n      setValidTimeRange(true);\n      return;\n    }\n    fetchTimeRange(value).then(({ value: actualRange, error }) => {\n      if (error) {\n        setEvalResponse(error || '');\n        setValidTimeRange(false);\n        setTooltipTitle(value || null);\n      } else {\n        /*\n          HRT == human readable text\n          ADR == actual datetime range\n          +--------------+------+----------+--------+----------+-----------+\n          |              | Last | Previous | Custom | Advanced | No Filter |\n          +--------------+------+----------+--------+----------+-----------+\n          | control pill | HRT  | HRT      | ADR    | ADR      |   HRT     |\n          +--------------+------+----------+--------+----------+-----------+\n          | tooltip      | ADR  | ADR      | HRT    | HRT      |   ADR     |\n          +--------------+------+----------+--------+----------+-----------+\n        */\n        if (\n          guessedFrame === 'Common' ||\n          guessedFrame === 'Calendar' ||\n          guessedFrame === 'Current' ||\n          guessedFrame === 'No filter'\n        ) {\n          setActualTimeRange(value);\n          setTooltipTitle(\n            getTooltipTitle(labelIsTruncated, value, actualRange),\n          );\n        } else {\n          setActualTimeRange(actualRange || '');\n          setTooltipTitle(\n            getTooltipTitle(labelIsTruncated, actualRange, value),\n          );\n        }\n        setValidTimeRange(true);\n      }\n      setLastFetchedTimeRange(value);\n      setEvalResponse(actualRange || value);\n    });\n  }, [guessedFrame, labelIsTruncated, labelRef, value]);\n\n  useDebouncedEffect(\n    () => {\n      if (timeRangeValue === NO_TIME_RANGE) {\n        setEvalResponse(NO_TIME_RANGE);\n        setLastFetchedTimeRange(NO_TIME_RANGE);\n        setValidTimeRange(true);\n        return;\n      }\n      if (lastFetchedTimeRange !== timeRangeValue) {\n        fetchTimeRange(timeRangeValue).then(({ value: actualRange, error }) => {\n          if (error) {\n            setEvalResponse(error || '');\n            setValidTimeRange(false);\n          } else {\n            setEvalResponse(actualRange || '');\n            setValidTimeRange(true);\n          }\n          setLastFetchedTimeRange(timeRangeValue);\n        });\n      }\n    },\n    SLOW_DEBOUNCE,\n    [timeRangeValue],\n  );\n\n  function onSave() {\n    onChange(timeRangeValue);\n    setShow(false);\n    onClosePopover();\n  }\n\n  function onOpen() {\n    setTimeRangeValue(value);\n    setFrame(guessedFrame);\n    setShow(true);\n    onOpenPopover();\n  }\n\n  function onHide() {\n    setTimeRangeValue(value);\n    setFrame(guessedFrame);\n    setShow(false);\n    onClosePopover();\n  }\n\n  const toggleOverlay = () => {\n    if (show) {\n      onHide();\n    } else {\n      onOpen();\n    }\n  };\n\n  function onChangeFrame(value: FrameType) {\n    if (value === NO_TIME_RANGE) {\n      setTimeRangeValue(NO_TIME_RANGE);\n    }\n    setFrame(value);\n  }\n\n  const overlayContent = (\n    <ContentStyleWrapper>\n      <div className=\"control-label\">{t('RANGE TYPE')}</div>\n      <StyledRangeType\n        ariaLabel={t('RANGE TYPE')}\n        options={FRAME_OPTIONS}\n        value={frame}\n        onChange={onChangeFrame}\n      />\n      {frame !== 'No filter' && <Divider />}\n      {frame === 'Common' && (\n        <CommonFrame value={timeRangeValue} onChange={setTimeRangeValue} />\n      )}\n      {frame === 'Calendar' && (\n        <CalendarFrame value={timeRangeValue} onChange={setTimeRangeValue} />\n      )}\n      {frame === 'Current' && (\n        <CurrentCalendarFrame\n          value={timeRangeValue}\n          onChange={setTimeRangeValue}\n        />\n      )}\n      {frame === 'Advanced' && (\n        <AdvancedFrame value={timeRangeValue} onChange={setTimeRangeValue} />\n      )}\n      {frame === 'Custom' && (\n        <CustomFrame value={timeRangeValue} onChange={setTimeRangeValue} />\n      )}\n      {frame === 'No filter' && <div data-test={DateFilterTestKey.NoFilter} />}\n      <Divider />\n      <div>\n        <div className=\"section-title\">{t('Actual time range')}</div>\n        {validTimeRange && (\n          <div>\n            {evalResponse === 'No filter' ? t('No filter') : evalResponse}\n          </div>\n        )}\n        {!validTimeRange && (\n          <IconWrapper className=\"warning\">\n            <Icons.ErrorSolidSmall iconColor={theme.colors.error.base} />\n            <span className=\"text error\">{evalResponse}</span>\n          </IconWrapper>\n        )}\n      </div>\n      <Divider />\n      <div className=\"footer\">\n        <Button\n          buttonStyle=\"secondary\"\n          cta\n          key=\"cancel\"\n          onClick={onHide}\n          data-test={DateFilterTestKey.CancelButton}\n        >\n          {t('CANCEL')}\n        </Button>\n        <Button\n          buttonStyle=\"primary\"\n          cta\n          disabled={!validTimeRange}\n          key=\"apply\"\n          onClick={onSave}\n          data-test={DateFilterTestKey.ApplyButton}\n        >\n          {t('APPLY')}\n        </Button>\n      </div>\n    </ContentStyleWrapper>\n  );\n\n  const title = (\n    <IconWrapper>\n      <Icons.EditAlt iconColor={theme.colors.grayscale.base} />\n      <span className=\"text\">{t('Edit time range')}</span>\n    </IconWrapper>\n  );\n\n  const popoverContent = (\n    <ControlPopover\n      placement=\"right\"\n      trigger=\"click\"\n      content={overlayContent}\n      title={title}\n      defaultVisible={show}\n      visible={show}\n      onVisibleChange={toggleOverlay}\n      overlayStyle={{ width: '600px' }}\n      getPopupContainer={triggerNode =>\n        isOverflowingFilterBar\n          ? (triggerNode.parentNode as HTMLElement)\n          : document.body\n      }\n      destroyTooltipOnHide\n    >\n      <Tooltip\n        placement=\"top\"\n        title={tooltipTitle}\n        getPopupContainer={trigger => trigger.parentElement as HTMLElement}\n      >\n        <DateLabel\n          label={actualTimeRange}\n          isActive={show}\n          isPlaceholder={actualTimeRange === NO_TIME_RANGE}\n          data-test={DateFilterTestKey.PopoverOverlay}\n          ref={labelRef}\n        />\n      </Tooltip>\n    </ControlPopover>\n  );\n\n  const modalContent = (\n    <>\n      <Tooltip\n        placement=\"top\"\n        title={tooltipTitle}\n        getPopupContainer={trigger => trigger.parentElement as HTMLElement}\n      >\n        <DateLabel\n          onClick={toggleOverlay}\n          label={actualTimeRange}\n          isActive={show}\n          isPlaceholder={actualTimeRange === NO_TIME_RANGE}\n          data-test={DateFilterTestKey.ModalOverlay}\n          ref={labelRef}\n        />\n      </Tooltip>\n      {/* the zIndex value is from trying so that the Modal doesn't overlay the AdhocFilter */}\n      <Modal\n        title={title}\n        show={show}\n        onHide={toggleOverlay}\n        width=\"600px\"\n        hideFooter\n        zIndex={1030}\n      >\n        {overlayContent}\n      </Modal>\n    </>\n  );\n\n  return (\n    <>\n      <ControlHeader {...props} />\n      {overlayStyle === 'Modal' ? modalContent : popoverContent}\n    </>\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nexport type SelectOptionType = {\n  value: string;\n  label: string;\n};\n\nexport type FrameType =\n  | 'Common'\n  | 'Calendar'\n  | 'Current'\n  | 'Custom'\n  | 'Advanced'\n  | 'No filter';\n\nexport type DateTimeGrainType =\n  | 'second'\n  | 'minute'\n  | 'hour'\n  | 'day'\n  | 'week'\n  | 'month'\n  | 'quarter'\n  | 'year';\n\nexport type CustomRangeKey =\n  | 'sinceMode'\n  | 'sinceDatetime'\n  | 'sinceGrain'\n  | 'sinceGrainValue'\n  | 'untilMode'\n  | 'untilDatetime'\n  | 'untilGrain'\n  | 'untilGrainValue'\n  | 'anchorMode'\n  | 'anchorValue';\n\nexport type DateTimeModeType = 'specific' | 'relative' | 'now' | 'today';\n\nexport type CustomRangeType = {\n  sinceMode: DateTimeModeType;\n  sinceDatetime: string;\n  sinceGrain: DateTimeGrainType;\n  sinceGrainValue: number;\n  untilMode: DateTimeModeType;\n  untilDatetime: string;\n  untilGrain: DateTimeGrainType;\n  untilGrainValue: number;\n  anchorMode: 'now' | 'specific';\n  anchorValue: string;\n};\n\nexport type CustomRangeDecodeType = {\n  customRange: CustomRangeType;\n  matchedFlag: boolean;\n};\n\nexport type CommonRangeType =\n  | 'Last day'\n  | 'Last week'\n  | 'Last month'\n  | 'Last quarter'\n  | 'Last year';\n\nexport const PreviousCalendarWeek = 'previous calendar week';\nexport const PreviousCalendarMonth = 'previous calendar month';\nexport const PreviousCalendarYear = 'previous calendar year';\nexport type CalendarRangeType =\n  | typeof PreviousCalendarWeek\n  | typeof PreviousCalendarMonth\n  | typeof PreviousCalendarYear;\n\nexport const CurrentDay = 'Current day';\nexport const CurrentWeek = 'Current week';\nexport const CurrentMonth = 'Current month';\nexport const CurrentYear = 'Current year';\nexport const CurrentQuarter = 'Current quarter';\nexport type CurrentRangeType =\n  | typeof CurrentDay\n  | typeof CurrentWeek\n  | typeof CurrentMonth\n  | typeof CurrentQuarter\n  | typeof CurrentYear;\n\nexport type FrameComponentProps = {\n  onChange: (timeRange: string) => void;\n  value: string;\n};\n\nexport interface DateFilterControlProps {\n  name: string;\n  onChange: (timeRange: string) => void;\n  value?: string;\n  onOpenPopover?: () => void;\n  onClosePopover?: () => void;\n  overlayStyle?: 'Modal' | 'Popover';\n  isOverflowingFilterBar?: boolean;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport moment from 'moment';\nimport { t } from '@superset-ui/core';\nimport {\n  SelectOptionType,\n  PreviousCalendarWeek,\n  PreviousCalendarMonth,\n  PreviousCalendarYear,\n  CommonRangeType,\n  CalendarRangeType,\n  CurrentRangeType,\n  CurrentWeek,\n  CurrentMonth,\n  CurrentYear,\n  CurrentQuarter,\n  CurrentDay,\n} from 'src/explore/components/controls/DateFilterControl/types';\n\nexport const FRAME_OPTIONS: SelectOptionType[] = [\n  { value: 'Common', label: t('Last') },\n  { value: 'Calendar', label: t('Previous') },\n  { value: 'Current', label: t('Current') },\n  { value: 'Custom', label: t('Custom') },\n  { value: 'Advanced', label: t('Advanced') },\n  { value: 'No filter', label: t('No filter') },\n];\n\nexport const COMMON_RANGE_OPTIONS: SelectOptionType[] = [\n  { value: 'Last day', label: t('Last day') },\n  { value: 'Last week', label: t('Last week') },\n  { value: 'Last month', label: t('Last month') },\n  { value: 'Last quarter', label: t('Last quarter') },\n  { value: 'Last year', label: t('Last year') },\n];\nexport const COMMON_RANGE_VALUES_SET = new Set(\n  COMMON_RANGE_OPTIONS.map(({ value }) => value),\n);\n\nexport const CALENDAR_RANGE_OPTIONS: SelectOptionType[] = [\n  { value: PreviousCalendarWeek, label: t('previous calendar week') },\n  { value: PreviousCalendarMonth, label: t('previous calendar month') },\n  { value: PreviousCalendarYear, label: t('previous calendar year') },\n];\nexport const CALENDAR_RANGE_VALUES_SET = new Set(\n  CALENDAR_RANGE_OPTIONS.map(({ value }) => value),\n);\n\nexport const CURRENT_RANGE_OPTIONS: SelectOptionType[] = [\n  { value: CurrentDay, label: t('Current day') },\n  { value: CurrentWeek, label: t('Current week') },\n  { value: CurrentMonth, label: t('Current month') },\n  { value: CurrentQuarter, label: t('Current quarter') },\n  { value: CurrentYear, label: t('Current year') },\n];\nexport const CURRENT_RANGE_VALUES_SET = new Set(\n  CURRENT_RANGE_OPTIONS.map(({ value }) => value),\n);\n\nconst GRAIN_OPTIONS = [\n  { value: 'second', label: (rel: string) => t('Seconds %s', rel) },\n  { value: 'minute', label: (rel: string) => t('Minutes %s', rel) },\n  { value: 'hour', label: (rel: string) => t('Hours %s', rel) },\n  { value: 'day', label: (rel: string) => t('Days %s', rel) },\n  { value: 'week', label: (rel: string) => t('Weeks %s', rel) },\n  { value: 'month', label: (rel: string) => t('Months %s', rel) },\n  { value: 'quarter', label: (rel: string) => t('Quarters %s', rel) },\n  { value: 'year', label: (rel: string) => t('Years %s', rel) },\n];\n\nexport const SINCE_GRAIN_OPTIONS: SelectOptionType[] = GRAIN_OPTIONS.map(\n  item => ({\n    value: item.value,\n    label: item.label(t('Before')),\n  }),\n);\n\nexport const UNTIL_GRAIN_OPTIONS: SelectOptionType[] = GRAIN_OPTIONS.map(\n  item => ({\n    value: item.value,\n    label: item.label(t('After')),\n  }),\n);\n\nexport const SINCE_MODE_OPTIONS: SelectOptionType[] = [\n  { value: 'specific', label: t('Specific Date/Time') },\n  { value: 'relative', label: t('Relative Date/Time') },\n  { value: 'now', label: t('Now') },\n  { value: 'today', label: t('Midnight') },\n];\n\nexport const UNTIL_MODE_OPTIONS: SelectOptionType[] =\n  SINCE_MODE_OPTIONS.slice();\n\nexport const COMMON_RANGE_SET: Set<CommonRangeType> = new Set([\n  'Last day',\n  'Last week',\n  'Last month',\n  'Last quarter',\n  'Last year',\n]);\n\nexport const CALENDAR_RANGE_SET: Set<CalendarRangeType> = new Set([\n  PreviousCalendarWeek,\n  PreviousCalendarMonth,\n  PreviousCalendarYear,\n]);\n\nexport const CURRENT_CALENDAR_RANGE_SET: Set<CurrentRangeType> = new Set([\n  CurrentDay,\n  CurrentWeek,\n  CurrentMonth,\n  CurrentQuarter,\n  CurrentYear,\n]);\n\nexport const MOMENT_FORMAT = 'YYYY-MM-DD[T]HH:mm:ss';\nexport const SEVEN_DAYS_AGO = moment()\n  .utc()\n  .startOf('day')\n  .subtract(7, 'days')\n  .format(MOMENT_FORMAT);\nexport const MIDNIGHT = moment().utc().startOf('day').format(MOMENT_FORMAT);\n\nexport const LOCALE_MAPPING = {\n  en: () => import('antd/lib/date-picker/locale/en_US'),\n  fr: () => import('antd/lib/date-picker/locale/fr_FR'),\n  es: () => import('antd/lib/date-picker/locale/es_ES'),\n  it: () => import('antd/lib/date-picker/locale/it_IT'),\n  zh: () => import('antd/lib/date-picker/locale/zh_CN'),\n  ja: () => import('antd/lib/date-picker/locale/ja_JP'),\n  de: () => import('antd/lib/date-picker/locale/de_DE'),\n  pt: () => import('antd/lib/date-picker/locale/pt_PT'),\n  pt_BR: () => import('antd/lib/date-picker/locale/pt_BR'),\n  ru: () => import('antd/lib/date-picker/locale/ru_RU'),\n  ko: () => import('antd/lib/date-picker/locale/ko_KR'),\n  sk: () => import('antd/lib/date-picker/locale/sk_SK'),\n  sl: () => import('antd/lib/date-picker/locale/sl_SI'),\n  nl: () => import('antd/lib/date-picker/locale/nl_NL'),\n};\n\nexport enum DateFilterTestKey {\n  CommonFrame = 'common-frame',\n  ModalOverlay = 'modal-overlay',\n  PopoverOverlay = 'time-range-trigger',\n  NoFilter = 'no-filter',\n  CancelButton = 'cancel-button',\n  ApplyButton = 'date-filter-control__apply-button',\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport moment, { Moment } from 'moment';\nimport { CustomRangeType } from 'src/explore/components/controls/DateFilterControl/types';\nimport { MOMENT_FORMAT } from './constants';\n\n/**\n * RegExp to test a string for a full ISO 8601 Date\n * Does not do any sort of date validation, only checks if the string is according to the ISO 8601 spec.\n *  YYYY-MM-DDThh:mm:ss\n *  YYYY-MM-DDThh:mm:ssTZD\n *  YYYY-MM-DDThh:mm:ss.sTZD\n * @see: https://www.w3.org/TR/NOTE-datetime\n */\nconst iso8601 = String.raw`\\d{4}-\\d\\d-\\d\\dT\\d\\d:\\d\\d:\\d\\d(?:\\.\\d+)?(?:(?:[+-]\\d\\d:\\d\\d)|Z)?`;\nconst datetimeConstant = String.raw`(?:TODAY|NOW)`;\n\nexport const ISO8601_AND_CONSTANT = RegExp(\n  String.raw`^${iso8601}$|^${datetimeConstant}$`,\n  'i',\n);\n\nconst SPECIFIC_MODE = ['specific', 'today', 'now'];\n\nexport const dttmToMoment = (dttm: string): Moment => {\n  if (dttm === 'now') {\n    return moment().utc().startOf('second');\n  }\n  if (dttm === 'today') {\n    return moment().utc().startOf('day');\n  }\n  return moment(dttm);\n};\n\nexport const dttmToString = (dttm: string): string =>\n  dttmToMoment(dttm).format(MOMENT_FORMAT);\n\nexport const customTimeRangeEncode = (customRange: CustomRangeType): string => {\n  const {\n    sinceDatetime,\n    sinceMode,\n    sinceGrain,\n    sinceGrainValue,\n    untilDatetime,\n    untilMode,\n    untilGrain,\n    untilGrainValue,\n    anchorValue,\n  } = { ...customRange };\n  // specific : specific\n  if (SPECIFIC_MODE.includes(sinceMode) && SPECIFIC_MODE.includes(untilMode)) {\n    const since =\n      sinceMode === 'specific' ? dttmToString(sinceDatetime) : sinceMode;\n    const until =\n      untilMode === 'specific' ? dttmToString(untilDatetime) : untilMode;\n    return `${since} : ${until}`;\n  }\n\n  // specific : relative\n  if (SPECIFIC_MODE.includes(sinceMode) && untilMode === 'relative') {\n    const since =\n      sinceMode === 'specific' ? dttmToString(sinceDatetime) : sinceMode;\n    const until = `DATEADD(DATETIME(\"${since}\"), ${untilGrainValue}, ${untilGrain})`;\n    return `${since} : ${until}`;\n  }\n\n  // relative : specific\n  if (sinceMode === 'relative' && SPECIFIC_MODE.includes(untilMode)) {\n    const until =\n      untilMode === 'specific' ? dttmToString(untilDatetime) : untilMode;\n    const since = `DATEADD(DATETIME(\"${until}\"), ${-Math.abs(\n      sinceGrainValue,\n    )}, ${sinceGrain})`;\n    return `${since} : ${until}`;\n  }\n\n  // relative : relative\n  const since = `DATEADD(DATETIME(\"${anchorValue}\"), ${-Math.abs(\n    sinceGrainValue,\n  )}, ${sinceGrain})`;\n  const until = `DATEADD(DATETIME(\"${anchorValue}\"), ${untilGrainValue}, ${untilGrain})`;\n  return `${since} : ${until}`;\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  NO_TIME_RANGE,\n  JsonObject,\n  customTimeRangeDecode,\n} from '@superset-ui/core';\nimport { useSelector } from 'react-redux';\nimport {\n  COMMON_RANGE_VALUES_SET,\n  CALENDAR_RANGE_VALUES_SET,\n  CURRENT_RANGE_VALUES_SET,\n} from '.';\nimport { FrameType } from '../types';\n\nexport const guessFrame = (timeRange: string): FrameType => {\n  if (COMMON_RANGE_VALUES_SET.has(timeRange)) {\n    return 'Common';\n  }\n  if (CALENDAR_RANGE_VALUES_SET.has(timeRange)) {\n    return 'Calendar';\n  }\n  if (CURRENT_RANGE_VALUES_SET.has(timeRange)) {\n    return 'Current';\n  }\n  if (timeRange === NO_TIME_RANGE) {\n    return 'No filter';\n  }\n  if (customTimeRangeDecode(timeRange).matchedFlag) {\n    return 'Custom';\n  }\n  return 'Advanced';\n};\n\nexport function useDefaultTimeFilter() {\n  return (\n    useSelector(\n      (state: JsonObject) => state?.common?.conf?.DEFAULT_TIME_FILTER,\n    ) ?? NO_TIME_RANGE\n  );\n}\n"],"names":["iso8601","String","raw","datetimeConstant","grainValue","grain","CUSTOM_RANGE_EXPRESSION","RegExp","ISO8601_AND_CONSTANT","DATETIME_CONSTANT","SEVEN_DAYS_AGO","Date","setHours","MIDNIGHT","defaultCustomRange","sinceDatetime","setDate","getDate","toString","sinceMode","sinceGrain","sinceGrainValue","untilDatetime","untilMode","untilGrain","untilGrainValue","anchorMode","anchorValue","customTimeRangeDecode","timeRange","splitDateRange","split","SEPARATOR","length","since","until","test","includes","customRange","matchedFlag","sinceCapturedGroup","match","dttm","slice","parseInt","untilCapturedGroup","sinceDttm","untilDttm","buildTimeRangeString","formatDateEndpoint","isStart","replace","formatTimeRange","columnPlaceholder","fetchTimeRange","async","shifts","query","endpoint","_isEmpty","rison","timeRanges","ensureIsArray","map","shift","_response$json3","response","SupersetClient","get","_response$json","_response$json$result","_response$json2","_response$json2$resul","timeRangeString","json","result","value","formatTimeRangeComparison","initialTimeRange","shiftedTimeRange","splitInitialDateRange","splitShiftedDateRange","clientError","getClientErrorObject","error","message","statusText","AntdRangePicker","AntdDatePicker","RangePicker","styled","theme","gridUnit","DatePicker","Popover","props","_jsx","AntdPopover","getSectionContainerElement","_document$getElementB","document","getElementById","lastElementChild","getElementYVisibilityRatioOnContainer","node","_window","_node$getBoundingClie","containerHeight","window","innerHeight","nodePositionInViewport","getBoundingClientRect","top","ControlPopover","getPopupContainer","getVisibilityRatio","visible","visibleProp","destroyTooltipOnHide","triggerElementRef","useRef","setVisible","useState","undefined","defaultVisible","placement","setPlacement","React","calculatePlacement","useCallback","visibilityRatio","current","changeContainerScrollStatus","element","style","setProperty","handleGetPopupContainer","triggerNode","body","handleOnVisibleChange","onVisibleChange","handleDocumentKeyDownListener","event","key","useEffect","addEventListener","removeEventListener","arrowPointAtCenter","CommonFrame","commonRange","COMMON_RANGE_SET","has","onChange","_jsxs","_Fragment","children","className","t","Radio","Group","e","target","COMMON_RANGE_OPTIONS","label","CalendarFrame","CALENDAR_RANGE_SET","PreviousCalendarWeek","CALENDAR_RANGE_OPTIONS","CurrentCalendarFrame","CURRENT_CALENDAR_RANGE_SET","CurrentWeek","newValue","trim","CURRENT_RANGE_OPTIONS","CustomFrame","datePickerLocale","setDatePickerLocale","customTimeRangeEncode","control","onGrainValue","_isInteger","localFromFlaskBabel","useSelector","state","_state$common","common","locale","LOCALE_MAPPING","then","default","catch","Loading","position","Row","gutter","Col","span","InfoTooltipWithTrigger","tooltip","Select","ariaLabel","options","SINCE_MODE_OPTIONS","showTime","defaultValue","dttmToMoment","datetime","format","MOMENT_FORMAT","allowClear","InputNumber","placeholder","Math","abs","min","onStep","SINCE_GRAIN_OPTIONS","UNTIL_MODE_OPTIONS","UNTIL_GRAIN_OPTIONS","align","option","radioValue","TIME_PICKER_HELPER","StyledTooltip","useTheme","ClassNames","css","Tooltip","overlayClassName","typography","sizes","m","weights","bold","s","DateFunctionTooltip","title","getAdvancedRange","startsWith","join","AdvancedFrame","advancedRange","Input","ACTIVE_BORDER_COLOR","LabelContainer","div","isActive","isPlaceholder","colors","grayscale","light5","light2","borderRadius","light1","dark1","DateLabel","forwardRef","ref","tabIndex","Icons","CalendarOutlined","iconSize","iconColor","base","StyledRangeType","ContentStyleWrapper","medium","IconWrapper","getTooltipTitle","isLabelTruncated","range","DateFilterLabel","_props$value","onOpenPopover","noOp","onClosePopover","overlayStyle","isOverflowingFilterBar","defaultTimeFilter","useDefaultTimeFilter","actualTimeRange","setActualTimeRange","show","setShow","guessedFrame","useMemo","guessFrame","frame","setFrame","lastFetchedTimeRange","setLastFetchedTimeRange","timeRangeValue","setTimeRangeValue","validTimeRange","setValidTimeRange","evalResponse","setEvalResponse","tooltipTitle","setTooltipTitle","labelRef","labelIsTruncated","useCSSTextTruncation","onHide","NO_TIME_RANGE","actualRange","useDebouncedEffect","SLOW_DEBOUNCE","toggleOverlay","overlayContent","FRAME_OPTIONS","Divider","ErrorSolidSmall","Button","buttonStyle","cta","onClick","disabled","EditAlt","popoverContent","trigger","content","width","parentNode","parentElement","modalContent","Modal","hideFooter","zIndex","ControlHeader","PreviousCalendarMonth","PreviousCalendarYear","CurrentDay","CurrentMonth","CurrentYear","CurrentQuarter","COMMON_RANGE_VALUES_SET","Set","CALENDAR_RANGE_VALUES_SET","CURRENT_RANGE_VALUES_SET","GRAIN_OPTIONS","rel","item","moment","utc","startOf","subtract","en","fr","es","it","zh","ja","de","pt","pt_BR","ru","ko","sk","sl","nl","DateFilterTestKey","SPECIFIC_MODE","dttmToString","_useSelector","_state$common$conf","conf","DEFAULT_TIME_FILTER"],"sourceRoot":""}